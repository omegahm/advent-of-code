input = <<~INPUT.strip
###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############
INPUT

input = <<~INPUT.strip
#################
#...#...#...#..E#
#.#.#.#.#.#.#.#.#
#.#.#.#...#...#.#
#.#.#.#.###.#.#.#
#...#.#.#.....#.#
#.#.#.#.#.#####.#
#.#...#.#.#.....#
#.#.#####.#.###.#
#.#.#.......#...#
#.#.###.#####.###
#.#.#...#.....#.#
#.#.#.#####.###.#
#.#.#.........#.#
#.#.#.#########.#
#S#.............#
#################
INPUT

require "rb_heap"

input = DATA.read
map = input.split("\n").map(&:chars)

graph = {}
dist = {}
paths = {}
startx, starty, stopx, stopy = nil
queue = Heap.new { |a, b| a[0] < b[0] }

map.each_with_index do |row, y|
  row.each_with_index do |elem, x|
    if elem == "S"
      startx, starty = [x, y]
    elsif elem == "E"
      stopx, stopy = [x, y]
    end

    if ".SE".include?(elem)
      graph[[x, y, "H"]] = [[x, y, "V", 1000]]
      graph[[x, y, "V"]] = [[x, y, "H", 1000]]

      graph[[x, y, "H"]] << [x-1, y, "H", 1] if x > 0 && ".SE".include?(row[x-1])
      graph[[x, y, "H"]] << [x+1, y, "H", 1] if x < row.size - 1 && ".SE".include?(row[x+1])
      graph[[x, y, "V"]] << [x, y-1, "V", 1] if y > 0 && ".SE".include?(map[y-1][x])
      graph[[x, y, "V"]] << [x, y+1, "V", 1] if y < map.size - 1 && ".SE".include?(map[y+1][x])
    end
  end
end

dist[[startx, starty, "H"]] = 0
queue << [0, startx, starty, "H"]

until queue.empty?
  cost, *node = queue.pop

  graph[node].each do |(nx, ny, ndirection, ncost)|
    alt = cost + ncost
    neighbour_node = [nx, ny, ndirection]

    if alt < dist.fetch(neighbour_node, Float::INFINITY)
      dist[neighbour_node] = alt
      paths[neighbour_node] = [node]
      queue << [alt, *neighbour_node]
    elsif alt == dist[neighbour_node]
      paths[neighbour_node] << node
    end
  end
end

puts "Part 1"
puts [dist[[stopx, stopy, "H"]], dist[[stopx, stopy, "V"]]].min

stop_tile = if dist[[stopx, stopy, "H"]] > dist[[stopx, stopy, "V"]]
  [stopx, stopy, "V"]
else
  [stopx, stopy, "H"]
end

def visit_tile(current, visited_tiles, paths, startx, starty)
  return if current == [startx, starty, "H"]

  next_tiles = paths[current]
  next_tiles.each do |tile|
    visit_tile(tile, visited_tiles, paths, startx, starty)
    visited_tiles << tile[0..1]
  end
end

visited_tiles = Set.new
visit_tile(stop_tile, visited_tiles, paths, startx, starty)

puts "Part 2"
puts visited_tiles.count + 1

if ENV["VISUALIZE"]
  puts "\033c"

  visited_tiles.each do |(x, y, _d)|
    print "\033[H"
    map[y][x] = "\e[38;2;255;0;0m@\e[0m"
    puts map.map(&:join).join("\n")
    sleep 0.1
  end
end

if ENV["IMAGE"]
  require "rmagick"

  height = map.size
  width = map[0].size

  data = Array.new(width) do |x|
    Array.new(height) do |y|
      case map[y][x]
      when "#"
        "black"
      when "S", "E"
        "blue"
      when "."
        "white"
      end
    end
  end

  img_list = Magick::ImageList.new
  img = Magick::Image.new(width, height)

  data.each_with_index do |row, y|
    row.each_with_index do |color, x|
      img.pixel_color(y, x, color)
    end
  end
  img_list << img.dup

  visited_tiles.each_with_index do |(x, y, _d), idx|
    print "\33[2K\rGenerating animation: #{((idx+1).fdiv(visited_tiles.size) * 100).round(1)}% done (#{visited_tiles.size} frames)..."
    img.pixel_color(x, y, "red")
    img_list << img.dup
  end

  image_name = "16.gif"

  puts "\nWriting #{image_name}..."
  img_list.write(image_name)

  puts "Optimizing #{image_name}..."
  `gifsicle --scale=8 --optimize=3 --lossy=200 --delay=1 --loopcount=0 --threads=4 --output=#{image_name} #{image_name}`
end

__END__
#############################################################################################################################################
#.............#.#.......#.....#.......#.....#.....#...#...#.............#...................#...#.........#.....#.....#...........#........E#
#.#########.#.#.#.###.#.###.#.#.#.#####.###.#.###.#.#.#.#.#.#######.###.#.#.#####.#########.###.#.###.###.###.#.###.###.#######.#.#.###.###.#
#.....#.....#.#.#.#.......................#.....#.#.#...#.......#...#.#.#.....#...#...#.........#...#...#.....#...#.....#.#...#.#.....#...#.#
#.#####.#####.#.#.#.#######.###.#####.#.#.#######.#.#####.#.###.#.###.#.###.###.###.###.###.#######.###.#########.#.#####.#.#.#.#####.###.#.#
#.#.....#.....#...#.....#...#...#.....#.#...#.....#.#.......#.#.#.#...#.....#...#.....#...#.#.....#.#.......#...#.#.........................#
###.#########.#########.#.###.###.#####.#.#.#.###.#.#.###.#.#.#.#.#.#######.#.#######.###.#.#.#.###.#.###.#.###.#.#######.#.#.###.#.#.#.###.#
#...#.......#.........#.#.#...#.#.......#.#.#...#.....................#.....#.......#.....#.#.#.....#.#...#.....#.....#...#.#...#.#.#.#.#...#
#.###.#####.#########.#.###.###.#.#######.#.###.###.#.###.#.###.#.#.#.#.###.#######.#.#####.#.#######.#.#.#####.#####.#.###.###.#.#.###.#.###
#.....#...#...#.....#...#...#...#.......#.#...#.....#...#...#...#.#.#...............#.#.....#.#...#...#...............#.#...#...............#
#######.#.###.#.###.###.#.###.#.#.###.#.#.###.#######.#.#.#.#.###.#.#######.#.#######.###.#.#.#.#.#.#####.#.#.#.#.#######.#####.#.#########.#
#...#...#.....#.#.#.#.#.....................#...#.#...#.......#...#...#...#...#.....#...#.#.#...#.#...#...#.#.#.#.#.............#.#.........#
#.#.#.#########.#.#.#.#.#.#####.###.###.###.###.#.#.#.###.#.###.#######.#.###.#.###.###.###.#.#######.#.#####.#.#.###.#.#.#.#.#.#.#.#########
#.#...#.........#.....#.......#.....#.#.....#...#.#.#...........#.....#.#...#.#.#.#.#.....#.#.#.......#.#...#...#.....#...#...........#.....#
#.#####.#######.#########.###.#######.#######.###.#.#.###.#.###.#.###.#.###.###.#.#.#####.#.#.#.#.#####.#.#.###########.###.#.#####.#.#.###.#
#.#.........#.#.#.............#.......#.......#...#.....#.....#.#...#.#.#.#.......#...#.#...#.#.#.#...#...#.....#.......#...#.#.......#...#.#
#.#########.#.#.#.#############.#####.#.#########.#####.#.###.#.#.###.#.#.###.#######.#.#.#.#.#.###.#.###.#####.#.#####.#.###.###.###.###.#.#
#.#.....#...#.#.#.#.....#.......#.....#.....#...#.....#.....#.#...#...........#.#.....#.#.#.#.#.....#...#.#...#...#...#.#.....#...#.....#.#.#
#.#.###.#.###.#.#.#.###.#.#######.#########.#.#.#####.#####.###.###.#.#######.#.#.#####.#.#.#.#########.#.#.#.###.#.#.###.#.#.#.#.#######.#.#
#...#...#.....#...#.#...#...#...#...#.....#...#.....#.....#...#...#.#.#...#...#.#...#.......#.#.......#.#.#.#...#.#.#.......#.#.#.........#.#
#####.#######.#####.#.#####.#.#####.#.#.#.###.#####.#####.###.#####.#.#.#.#.###.###.#######.#.#####.###.#.#.###.###.#######.###.#.#########.#
#...#.#.#...#.#.....#.....#.#.....#...#.#...#...#...#...#...#.....#.#.....#...#...#.#.....#.#.....#...#.#.#.#.#.....#.......#...#.......#...#
#.#.#.#.#.#.#.###.#.#.###.#.#####.###.#.###.#.#.#.###.#.#.#######.#.###.#.###.#.###.#.###.#.#####.###.#.###.#.#######.#######.###.#.###.#.###
#.#...#...............#.#.#.....#...#.#.#.#...#.#.#...#.#.#.......#...#.#.....#...#.....#.#...#.......#.....#.......#.........#...#...#.#...#
#.#####.###.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.###.#.#.#.#####.#.#.#.#######.#######.#####.#####.###.#.#.#.#################.###.#####.#
#.#.#...#.#.#...#...#...#...#.#...#...#.#.....#.#...#...#.#.#.#...#.#.#.#.#.......#.#...#.#.....#...#.#.#...#.#.......#.........#...#...#...#
#.#.#.###.#.#####.#####.#####.#######.#.#.###.#.#####.###.#.###.#.#.#.#.#.#.#.###.#.#.#.#.#.#####.#.#.#.#####.#####.#.#.#.#.###.#.#.###.#.###
#.#.......#.....#.....#...#.....#.....#.#...#...#...#.....#.....#.#.#.#.#...#...#.#...#.#...#.....#.#.#.....#.#.....#.#.#...#.#.#.#.....#...#
#.#######.#####.#.###.###.#####.###.###.#####.#####.#####.#######.###.#.#######.#.#.#.#.#####.#####.#.#.###.###.#####.#.#.###.#.#.#####.###.#
#...#.#...#...#.....#...#.....#...#...#.....#.......#.....#.........#.#.....#...#...#.............#.#.#...#.#...#...#.#.#.#...#...#...#...#.#
###.#.#.###.#.###.#####.#####.#.#.#.#######.#########.#########.###.#.#.###.#.#####.#.#############.#.###.#.#.###.###.###.###.###.#.#.###.#.#
#...#.#.#...#...#...........#.#.#.........#.#...#.....#...#.....#.#.#...#.#.#.#.....#.#.....#.......#.....#...#.........#...#.....#.#.....#.#
#.###.#.#.###.###.#####.#.###.#####.#####.#.#.#.#.#####.#.#.###.#.#.#.#.#.#.#.#.#####.###.#.#.###.#####.#.#########.###.###.#.#####.#######.#
#...#.#.#.#.#.#.......#.#...#.....#.....#.#...#.#.....#.#...#...#.#.#.#.#.....#.#...#...#.#.#.#...........#.......#...#.....#.....#.#.....#.#
#.#.#.#.#.#.#.#.#####.#.###.#####.#######.#####.#####.#.#####.###.#.#.#.###.###.#.#.###.###.#.#########.###.#####.#.#.#######.###.#.#.#####.#
#.............#...#.#.#.....#...#...#...#.....#.......#.....#.#...#.......#.#...#.#...#.....#.....#...........#...#.#.........#.#...#.......#
#.###.#########.#.#.#.#####.#.#####.#.#.#.###.#############.#.###.###.###.###.###.###.#####.#####.#.###.#####.#.###.###########.#######.#.###
#.#...#.....#.......#...#...#.......#.#.#...#.........#.....#...#...#...#...#...#...#.....#.#...#.......#...#.#...#...#.......#.......#.#...#
#.#####.###.#.#########.#.###.#.#.#.#.#.###.#####.###.#.#######.###.###.###.###.###.###.#.#.###.#########.#.###.#.###.#.#####.#.#####.#.###.#
#.#...#...#...#.........#.#...#.#.#.#.#.....#.......#.#.#.#...#...#.#...#.....#.......#.#.#...#.....#.....#...#.#.#...#...#.#.#.#...#.#.#...#
#.#.#.###.#####.#########.#.###.#.#.#.#######.#####.#.#.#.#.#.###.#.#.###.#######.#.#.#.#####.#.###.#.#######.###.#.#####.#.#.#.#.###.#.#.###
#.#.#...#...#.#.........#.#...#.#...#...#...#.#...#.#...#...#...#.#.#.#.........#...#.#.....#...#...#...#...#.....#.#.....#.#...#.......#...#
#.#.###.###.#.#########.#.###.#.###.###.#.#.#.#.###.#####.#####.#.#.#.#####.###.###.#####.#######.#####.#.#.#######.#.#####.#####.#########.#
#.#...#.....#.......#...#.......#.....#.#.#.#.#.#.......#.#.#...#...#.#...#...#...#.....#.#...#...#...#...#.#.....#.#.#...........#.....#...#
#.###.#######.###.#.#.#.#####.#.###.#.#.#.###.#.#.#####.#.#.#.#.###.#.#.#.#######.#####.#.#.#.#.###.#.###.#.#.#.###.#.#.###########.###.#.###
#...#.#.........#.#.#.....#...#.........#.......#.....#.#.#.#.#.#...#...#.......#.....#...#.#...#...#...#...#.#.#...#.#.........#...#.#.#...#
#.#.#.#####.#.#.#.#.#####.#.#############.#####.#####.#.#.#.#.###.#############.#.#.###.###.#####.#####.#.###.#.#.###.#########.#.#.#.#.###.#
#.#.#.#.....#...#.#.#.....#.#...#...#...#.#.......#...#.#...#.#...#.....#.....#.#.#.#...#...#.....#.....#.#.#.#.#...#.#.......#.............#
#.#.#.#.#####.#####.#.#######.#.#.#.#.#.#.#.#.#####.#####.###.#.#.#.###.#.###.#.#.#.#.###.#####.###.#####.#.#.#.###.#.#.#.#####.#.#.#.#####.#
#.#...#.#.#...#.....#...#.....#...#.#.#...#.#...#...#.....#...#...#...#.......#.#.#.....#.#.....#.....#...#...#...#.#.#.#.....#.#.#.#.....#.#
#.#####.#.#.#.###.#.###.#.#########.#.#########.#.###.#.###.#####.###.#####.###.#.#######.#.#.###.#####.#########.#.#.#.#####.#.#.#.###.###.#
#.#.....#.#.#.....#.#...#.#...#.#.....#.........#.....#...#.#...#.....#.#.....#.#...#...#.#...#...#...............#...#...#...#.#.#...#.#...#
#.#.#.#.#.#.#.#######.#.#.#.#.#.#.#.#.#.#######.###.#.#.#.#.#.#.#.#.###.#.###.#.#####.#.#.###.#.###.#####.#######.#######.#.###.#.#.#.###.###
#.#.#...#.#.#.......#.#.#...#.#.#.#.#.#...#...#...#...#.#...#.#...#.....#.#...#...#...#.#...#.#...#.#.....#.....#.#.#.....#.....#.#.#...#...#
#.###.#.#.#.#.#.###.#.#######.#.#.###.###.#.#.###.#####.#.#.#.#####.#.#.#.#.#####.#.###.###.#.###.#.#.#####.###.#.#.#.###########.#.###.###.#
#...#.#.#.....#.#...#.#.......#.#...#.#...#.#...#.#...#.#...#.#.....#.#...#.....#.#.#.....#.#.#...#.#...#...#.#...#.#.......#...............#
###.#.#.#####.#.#.#.#.#.#######.###.#.#.#######.#.#.#.#.#####.#.#####.###.#.###.#.#.#.###.#.#.#.###.#.#.###.#.#####.#####.###.#####.#.#######
#.#...#...#...#.#.#.#...#.............#...#...#...#.#.#.....#.#...#.#.....#.#...#...#.#...#...#...#.#.....#...........#...#...#...#...#.#...#
#.###.#.#.#.#####.#####.#####.#.#######.#.#.#.#.#####.#####.#.#.#.#.#.#######.#.#####.#.#.#.#######.#.###.#######.#####.###.###.#.#.###.#.#.#
#...#.....#.....#.......#...#.#.....#.#.#...#.#.....#.#...#...#.#.#.#.#.....#.#...#.#.#...#.#.....#.#...#.#...#...#.....#.#.................#
#.###.#########.#.###.#.#.#.#####.#.#.#.#####.#####.#.#.#.#######.#.#.#.#.#.#.###.#.#.#.###.#.###.#.#####.#.#.#####.#####.#######.#.#.#####.#
#.....#.#...#...#.#.#.#...#.......#.#...#.....#...#.#.#.#.#.......#.#.#.#.#...#.#...#.#.#...#.#.#.#.....#...#.#.....#...#...#...#...#...#...#
###.#.#.#.#.#.###.#.#.#############.#.###.#.###.###.#.#.#.#.#.#####.#.###.#####.###.#.###.###.#.#.#.###.#.###.#.#####.#.###.#.#.###.###.#.###
#...#...#.#...#.....#.....#.....#...#...#.....#.#...#...#.#.#.#.....#...#...#.......#.....#.....#.#...#.#...#...#.#...#...#...#.#...#.#.#...#
#.###.#.#.#######.###.###.###.###.#####.#####.#.#.#####.#.#.#.###.#.###.#.#.#####.#####.###.###.#.###.#.###.#####.#.#.###.###.#.#.#.#.#.#.#.#
#.#.....#...#.......#.#.#...#.....#.....#...#.#.......#.#...#...#.#.....#.#.....#...#.....#.#...#.#.#.#...#...#.....#...#...#...........#.#.#
#.###.#####.#.#####.#.#.###.#.#.###.###.###.#.#######.#########.#.#############.###.#.###.#.#.###.#.#.###.###.#####.###.###.###.#.#.#####.#.#
#.#.......#...#.....#...#...#...#...........#.....#.#...........#...............#...#.#.#.#.......#.....#.#.#.#...#.#...#...#...#.#...#...#.#
#.#.#.#.#.#####.#####.#.#.#####.###########.###.#.#.###############.#########.#######.#.#.#.#.#####.#####.#.#.#.#.###.###.###.###.#.#.#.#.#.#
#.#...#.#...#.#.....#...#.#...#.....#.....#.....#.#...#.....#.......#.......#.#.......#...#.#.....#.#.....#.....#...#.#.#.#.#...#.#.....#.#.#
#.###.#.###.#.#####.#####.#.#.#####.###.#.###.###.#.#.#.###.#.###.#.#.#####.###.#######.###.#####.###.#############.#.#.#.#.#.#.#.#######.#.#
#...#.#...#.#.....#.......#...#.....#...#.#...#...#.#.....#...........#.#.....#...#.........#...#.....#...........#...#...#...#.#.....#.#...#
#.###.###.#.#####.#########.###.#####.###.#.###.#########.#####.#####.#.#####.###.#.#########.#.#######.#.#######.#.###.#######.#####.#.#.#.#
#.#...#...#.....#.#.............#.....#...#.#.#.#.....#...#...#.#...#.#.....#.#...#.#...#...#.#.........#...#.....#.#...............#.#...#.#
#.#.###.#.#####.#.#.#############.#########.#.#.#.###.#.#####.#.#.#.#######.#.#.#####.#.#.#.#.#####.#####.#.#.#####.#.#########.#####.#.#.#.#
#...#...#.#...#...#.#...#.......#.....#.......#...#...#...#...#.#.#.......#.#.#.......#.#.#.......#...#...#...#.......#.....#...............#
#.###.#.###.#.#####.#.#.#.#.###.#.###.#.###########.###.#.#.###.#.#####.###.#.#######.#.#.#.#########.#.###############.###.#####.###.#.#.#.#
#...#.#...#.#...#...#.#...#.....#...#.#.#...#.....#.#.#...#...#.#.....#.....#.......#.#.#.....#.....#.#.#...........#...#...#.........#.#.#.#
###.#.#.#.#.###.#.###.#####.#.#######.#.#.#.#.###.#.#.#.#####.#.###.#####.#.#######.###.#####.#.###.#.#.###.#######.#.###.#.#.#####.#.#.#.#.#
#...#.#.#...#.#...#.#...#.#...#.......#.#.#.#.#...#.#...#.....#.....#.....#...#.......#.#...#.#.#.....#...#.#.#.......#.......#...#.#...#...#
#.###.#.#####.#.###.#.#.#.###.#.#.###.#.#.#.#.#.###.#.#####.#.#.#####.#######.#######.#.###.#.#.#.#######.#.#.#.###.###########.###.#.###.###
#...#.#.#.......#...#.#.....#.#.#.#.....#.#.#.#...#.#...#...#.#...#...#...........#.#.#...#...#.#.#.....#...#.....#.......#.#.......#.#.....#
#####.#.###.###.#.#.#.#.###.#.###.#####.#.###.###.#.###.#.###.#.#.#.###.#.#.#####.#.#.#.#.#####.###.###.###########.#####.#.#.#######.#.#.#.#
#.....#...#...#.#.#...#...#.......#.....#...#...#.#.#.....#.#.#.#.#...#...#.......#...#.#...#...#...#...#.............#...#.#.....#...#...#.#
#.#####.#.###.#.#.#######.#######.#.#######.###.#.#.#######.#.#.#.###.###.#########.###.#.#.#.#.#.###.###.#############.###.#####.###.###.#.#
#.#...#...#...#...#.#.....#...#...#...........#...#.#...#...#.#.#...#.#...........#...#...#.#.#.#.#.#...#...........#...#.......#.#.....#.#.#
#.#.#.#.#######.###.#.#.###.#.#.###.#.#####.###.#.#.#.#.#.#.#.#.#.###.#.###.###.#.###.###.#.#.###.#.###.#.#.#######.#.###.#.#####.#.#.###.#.#
#.#.#...#.....#...#.#.#.#...#.#.#...#.....#.#...#.#...#.#.#.#...#.#...#.#...#...#.#.#.#...#.#.........#.#.#...#...#.#.#...#.#.....#.#.....#.#
#.#.###.###.#.###.#.#.###.###.#.#.###.###.#.#.###.#####.###.#####.#.###.#.###.###.#.#.###.#.###.###.###.#.###.#.#.###.#####.#.#####.#.#####.#
#...#.......#.......#.#...#...#.#...#...#.#.#.#.#.....#...#.#.....#.#...#.#...#.#.#.#...#.#.#...#...#...#.#...#.#.#...#...#.......#.......#.#
#.###.#########.#.###.#.###.#.#####.###.#.#.#.#.#####.#.#.#.#.#####.#.###.#.###.#.#.###.###.#.###.###.#.#.#.#.#.#.#.###.#.#######.###.#####.#
#.#...#.#.....#.#.#...#.#...#.....#.#...#...#.#.......#.#.#.......#.#...#.#.#.#...#...#.....#.......#.#.#...#.#.#...#...#.......#...........#
#.###.#.#.#.#.#.#.#.###.###.###.#.#.#####.#.#.#######.###.#######.#.#.#.#.#.#.#.#####.###############.#######.#.###.#.#########.#.###.#######
#.....#.........#.#...........#.#.#.........#.......#.....#...#...#...#.#.#...#.#.........#...........#.......#.#...#...#...#.#.........#...#
#######.###.#####.#######.###.#.###########.#######.#####.#.#.#####.#.#.#.#.#.#.###.#######.#.#########.#####.#.###.###.#.#.#.###.#####.#.#.#
#...............#.....#...#...#...#.......#.......#.....#.#.#.....#.#.#...#.#.#.............#...........#...#.#...#.#...#.#.........#.#.#.#.#
#.###.#.#.#.#.#.#####.#.###.#####.#.###.###.###########.#.#.#####.###.###.#.#.###.#.#####################.#.#.###.###.###.#######.#.#.#.#.#.#
#.....................#.#...#.....#...#.....#.......#...#.#.#...#...#...#...#.....#...#...........#.....#.#.#.#.....#...#.........#...#.#.#.#
###.#.#.###.#.#.#.#####.#.###.#######.#######.#####.#.###.#.###.###.#.#######.#######.#######.#.#.#####.#.#.#.#.###.###.#.#####.#.###.#.#.#.#
#...#.#.....#.#...#.....#.....#.....#.......#...#.#...#...#...#.......#.......#.....#.#.........#...#...#.#.#.....#...#.#.#...#.#...#.#...#.#
#.###.#########.###.#######.#.#.#.#########.###.#.#####.#####.#######.#.#.#####.#.###.#.###########.#.###.#.#####.#.###.#.#.#.###.#.#######.#
#.#...#.......#.#.......#.#.#.#.#.........#.#...#...#...#...#.......#.#.#.....#.........#...#...#.....#...#.#.....#.#...#.#.#...#.#.#.......#
#.#.#.#.#####.#.#.#####.#.#.#.#.#####.#####.#.###.###.###.#.#######.#.#.#.###.#.#########.#.#.#.#.#####.###.#.#####.#.#####.###.#.#.#.#####.#
#.#.....#.#...#.#.....#.#...#.......#.#.....#.#.......#...#.....#.#.#.#.#.#.#.#.......#...#...#.#.#...#.#...#.....#.#.....#...#...#.#.#.....#
#.###.###.#.###.###.###.###########.#.#.#####.#####.#####.#####.#.#.###.#.#.#.#########.#######.###.#.#.#.#######.#.#####.#.#.###.#.#.#####.#
#...........#.#.........#...#...#...#.......#.#...#...#...#...#...#...#.#.#.............#.#.....#...#...#.............#...#.#...#...#.....#.#
#.#####.#.###.###.#######.#.#.#.#.###########.#.#.###.#.#####.#.#####.#.#.###############.#.#####.#######.###.#######.#.#######.###.#.###.###
#.#.#...#...#.....#.......#...#.#.....#.#.....#.#.#...#...#...#.#.....#.#...#.............#.....#.#.....#...#.#...#...#...#.....#.#.#...#...#
#.#.#.#####.#######.###########.#####.#.#.#####.#.###.###.#.###.#.#####.###.#######.#.#########.#.#####.###.#.#.#.#######.#.#####.#.###.###.#
#.#.#.......#.......#...#.....#...#.#...#...#...#...#.....#.....#.....#.#...#.....#.#.......#...#...#.....#.#.#.#.#.......#...#.#.........#.#
#.#.#.#####.#.#######.#.###.#####.#.###.###.#.#####.#######.#########.#.#.###.###.#########.#.#####.#.#####.#.#.#.#.#.#####.#.#.#.#.#######.#
#.#.......#...........#.....#.....#.......#.#.#...#.#.........#.....#...#.#...#.............#.#.....#.#...#.#...#.........#.#.#...#.......#.#
#.#.#.###.#.###.#.#########.#.#####.#######.#.#.###.#########.#.###.#####.#.###############.#.###.###.#.#.#.#.###########.###.#.###.#####.#.#
#...#...#...#...#.#...#.....#...#...#.......#...#...#.....#...#.#...#.#...#.........#.......#...#.#.....#.#.#.#...#.....#.#...#...#...#.#.#.#
#####.#.###.#.###.#.#.#.#####.#.#.###.#######.#.#.###.###.#.###.#.###.#.#.#####.###.###########.#.#####.#.#.###.#.#####.#.#.#.#####.#.#.#.#.#
#...#.#.....#...#.#.#...#.....#.#...#.......#.#...#...#...#.......#...#.#.........#.........#...#.....#.#.......#.....#.....#.#.......#.#.#.#
#.###.#####.###.#.#.#####.#.###.#####.#####.#.#.###.###.#########.#.###.#####.###.#########.#.#######.###############.#######.#.#######.#.#.#
#.....#.......#.#.#.......#.#...#.........#.#.#.....#.#...#...#...#.........#...#.........#.#.......#.......#.....#.#...#.....#.....#...#...#
#.###.#####.#.#.#.#.#.#.###.#.###.#####.#.#.#.#####.#.###.#.#.#.#####.#########.###########.#######.#######.###.#.#.###.#####.#####.#.#.###.#
#...........#...#.#.#.#.#...#.....#.....#.#.#.#...#...#.#...#.#.....#...#.....#...........#.......#.......#.....#.#...#.#...#.#...#...#.....#
#####.#######.###.#.###.#.#########.#.###.#.#.#.#.#.#.#.#####.#####.#####.###.#.#########.#.#####.#######.###.#.#.#.#.#.#.#.#.#.#.#.#.###.###
#.#...#...........#.....#.#.......#.#...#.#...#.#...#...#.....#.......#...#...#.#.......#.#...#.#.......#.....#.#...#.#...#.#.#.#.#.#...#...#
#.#.#.#.#.###.###.###.#####.###.###.###.#.#.###.#######.#.###.#####.#.#.###.#####.#####.#.###.#.#######.#######.###.#######.#.#.#.###.#.###.#
#...#...#...#...#.....#.....#...#...#.#...#.#...#.#...#.#...#.#...#.....#...#...#...#.#.#...#.#.......#...#.....#.#.#.....#.#.#.#...#.#.#...#
#.#########.#.#.#######.###.#.###.###.#####.#.#.#.#.#.#.###.###.#.#######.###.#.#.#.#.#.#.#.#.#.#####.###.#.###.#.#.#.###.#.###.###.#.#.#.###
#.#.......#.#.#...#.....#...#...#.#.....#.#.#...#...#.....#.....#.#.....#.#...#.#.#.#.....#.#.#.....#...#.#.....#...#.#...#...#...#.....#...#
#.###.###.#.#.###.#.#.###.#.###.#.#.#.#.#.#.#.#####.###########.#.#.###.#.#.###.#.#.#######.#.#####.#.#.#.###.#.#.###.#.#####.###.###.#.#.#.#
#...#...#.#.#...#.#.#.............................#.....#.....#.#...#...#.#.#.....#.....#.............#.....#.#.#.#...#.......#...#.....#...#
###.###.#.#.#.#.#.#.#.#####.#.#.#####.#.#.#####.#.#####.#.###.#.#####.###.#.#.#####.###.#.#########.###.#####.#.#.#.###########.#####.#.#.###
#.#...#.#.#.....#.#...........#...#.....#.#.............#...#.#.#...#...#...#.#...#.#.#.#...#...........#.....#.#.#.............#.....#...#.#
#.###.###.###.###.###.#.#########.#.#.###.#.###########.#.#.#.#.#.#.###.#####.#.#.#.#.#.#####.#.###.###.#.#####.#.###.#####.###.###.#.#.#.#.#
#.................#.....#.........#.#.....#...#.....#.........#...#.#...#...#...#.........................#.....#.#.#.#...#...#.............#
#.#######.###.#####.#.###.#########.#.###.#.#.#.###.#.#.#.#.#.#######.#.#.#.#####.#######.#.###.#.#####.###.#####.#.#.#.#.#######.#.#.#.#.#.#
#.....#...#...#...#.#...#...........#...#.#.#.....#.#.#.#.#.#.......#.....#...#.#.#.......#.#...#.#.......#.#.....#.#...#.....#...#...#.#.#.#
#.#.###.###.#.#.#.#.#.#.#############.#.#.#.#######.#.#.###.#######.###.#####.#.#.#.#######.###.#.#.#.#####.#.#####.#########.#.###.#.#.#.#.#
#.#.....#.#.....#.#.....#.....#.......#.#...#...#...#.#.#...#.....#...........#...#.#.....#...#.#.#.#.....#.#.........#.....#.#.#.#.#.....#.#
#.#######.#######.#####.#.###.#.#.###.#.#####.#.#.###.#.#.###.#.#######.#####.#.###.#.###.#.#.#.#.#######.#.#########.#.###.#.#.#.#.#####.#.#
#.....#.....#...#.....#.#.#.#.....................#...#...#...#.#.......#.....#.....#.#.#.#.#.#.#.#.......#.#.......#.#...#.#...#.#...#...#.#
#.#.#.###.#.#.#.###.###.#.#.#.#####.#.###.#########.#.#####.###.#.#####.#.#.#########.#.#.#.#.###.#.#####.#.#.#####.#####.#.#####.###.#.#.#.#
#S..#.....#...#...#.......#.........#.....#.........#.........#.......#...#.............#...#.......#.....#.......#.......#.............#...#
#############################################################################################################################################
